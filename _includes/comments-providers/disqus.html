{% if site.comments.disqus.shortname %}
<div id="disqus_thread"></div>

<script>
  var disqus_config = function () {
    this.page.url = "{{ page.url | absolute_url }}";
    this.page.identifier = "{{ page.id }}";
  };

  (function () {
    var d = document, s = d.createElement('script');
    s.src = 'https://{{ site.comments.disqus.shortname }}.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    s.async = true;
    s.onerror = function () {
      var fb = document.getElementById('disqus-fallback');
      if (fb) fb.hidden = false;
    };
    (d.head || d.body).appendChild(s);
  })();
</script>

<script>
  // Reveal fallback if Disqus never initializes (blocked or network failure)
  setTimeout(function () {
    if (!window.DISQUS) {
      var fb = document.getElementById('disqus-fallback');
      if (fb) fb.hidden = false;
    }
  }, 2500);
</script>

<noscript>
  Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
{% endif %}